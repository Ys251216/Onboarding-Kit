<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×¢×¨×›×ª × ×—×™×ª×” ×¨×›×” - Dark Mode Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="icon" href="data:,">
    <style>
        body { font-family: 'Heebo', sans-serif; background-color: #020617; color: #94a3b8; }
        .nav-item.active { background-color: #1e293b; border-right: 4px solid #14b8a6; color: #2dd4bf; font-weight: 700; }
        .card-bg { background-color: #0f172a; border: 1px solid #1e293b; }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-2px); background-color: #1e293b; border-color: #334155; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5); }
        .chart-container { position: relative; width: 100%; max-width: 400px; margin: auto; height: 250px; }
        .modal-overlay { background-color: rgba(0, 0, 0, 0.8); backdrop-filter: blur(4px); }
        .loading-spinner { border: 3px solid rgba(255,255,255,0.1); width: 24px; height: 24px; border-radius: 50%; border-left-color: #2dd4bf; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="flex h-screen overflow-hidden">
    <aside class="w-64 bg-slate-900 shadow-2xl z-10 hidden md:flex flex-col border-l border-slate-800">
        <div class="p-6 border-b border-slate-800 flex items-center justify-center">
            <h1 class="text-2xl font-bold text-teal-500">ğŸš€ × ×—×™×ª×” ×¨×›×”</h1>
        </div>
        <nav class="flex-1 overflow-y-auto py-4">
            <ul class="space-y-1">
                <li><button onclick="navigateTo('home')" class="nav-item w-full text-right px-6 py-3 hover:bg-slate-800 flex items-center gap-3 transition-colors active" id="nav-home">ğŸ  ×¨××©×™</button></li>
                <li><button onclick="navigateTo('checklist')" class="nav-item w-full text-right px-6 py-3 hover:bg-slate-800 flex items-center gap-3 transition-colors" id="nav-checklist">âœ… ×¦'×§-×œ×™×¡×˜</button></li>
                <li><button onclick="navigateTo('dictionary')" class="nav-item w-full text-right px-6 py-3 hover:bg-slate-800 flex items-center gap-3 transition-colors" id="nav-dictionary">ğŸ“š ××™×œ×•×Ÿ ××•× ×—×™×</button></li>
                <li><button onclick="navigateTo('contacts')" class="nav-item w-full text-right px-6 py-3 hover:bg-slate-800 flex items-center gap-3 transition-colors" id="nav-contacts">ğŸ‘¥ ×× ×©×™ ×§×©×¨</button></li>
                <li><button onclick="navigateTo('links')" class="nav-item w-full text-right px-6 py-3 hover:bg-slate-800 flex items-center gap-3 transition-colors" id="nav-links">ğŸ”— ×§×™×©×•×¨×™×</button></li>
                <li><button onclick="navigateTo('culture')" class="nav-item w-full text-right px-6 py-3 hover:bg-slate-800 flex items-center gap-3 transition-colors" id="nav-culture">ğŸ’¡ ×ª×¨×‘×•×ª</button></li>
                <li><button onclick="navigateTo('ai-chat')" class="nav-item w-full text-right px-6 py-3 hover:bg-slate-800 flex items-center gap-3 transition-colors text-teal-400 font-medium" id="nav-ai-chat">âœ¨ ××¡×™×™×¢ AI</button></li>
            </ul>
        </nav>
    </aside>

    <main class="flex-1 overflow-y-auto p-4 md:p-8 transition-all relative">
        <section id="home" class="space-y-8 max-w-4xl mx-auto">
            <div class="bg-gradient-to-l from-teal-700 to-teal-950 text-white rounded-2xl p-8 shadow-2xl border border-teal-800/50">
                <h2 class="text-3xl font-bold mb-4">×‘×¨×•×›×™× ×”×‘××™× ×œ×¦×•×•×ª! ğŸ‘‹</h2>
                <p class="text-teal-100 text-lg leading-relaxed">×›××Ÿ ×ª×•×›×œ×• ×œ××¦×•× ×”×›×œ. ××”××•× ×—×™× ×”××§×¦×•×¢×™×™× ×•×¢×“ ××™ ×¢×•×–×¨ ×›×©×”××§×œ×“×ª × ×©×‘×¨×ª.</p>
            </div>
        </section>

        <section id="checklist" class="hidden space-y-6 max-w-5xl mx-auto">
            <div class="flex justify-between items-center">
                <h2 class="text-3xl font-bold text-slate-50">×¦'×§-×œ×™×¡×˜</h2>
                <div class="flex gap-2">
                    <button onclick="openForm('checklist')" class="bg-teal-600 text-white px-4 py-2 rounded-lg font-bold">â• ×”×•×¡×¤×”</button>
                    <button onclick="openAiTaskModal()" class="bg-slate-800 text-teal-400 px-4 py-2 rounded-lg font-bold">âœ¨ AI</button>
                </div>
            </div>
            <div id="task-list-container" class="space-y-4"></div>
            <div class="card-bg p-6 rounded-xl text-center">
                <h3 class="text-lg font-semibold mb-4 text-slate-200">×”×ª×§×“××•×ª</h3>
                <div class="chart-container"><canvas id="progressChart"></canvas></div>
                <p id="progress-text" class="mt-4 font-bold text-teal-400 text-2xl">0%</p>
            </div>
        </section>

        <section id="dictionary" class="hidden space-y-6 max-w-5xl mx-auto">
            <div class="flex justify-between items-center">
                <h2 class="text-3xl font-bold text-slate-50">××™×œ×•×Ÿ ××•× ×—×™×</h2>
                <button onclick="openForm('dictionary')" class="bg-teal-600 text-white px-4 py-2 rounded-lg font-bold">â• ×”×•×¡×¤×”</button>
            </div>
            <input type="text" id="search-term" placeholder="×—×™×¤×•×©..." class="w-full p-4 rounded-full bg-slate-900 border border-slate-700 text-slate-100 outline-none" oninput="renderDictionary()">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="terms-grid"></div>
        </section>

        <section id="contacts" class="hidden space-y-6 max-w-6xl mx-auto">
            <div class="flex justify-between items-center">
                <h2 class="text-3xl font-bold text-slate-50">×× ×©×™ ×§×©×¨</h2>
                <button onclick="openForm('contacts')" class="bg-teal-600 text-white px-4 py-2 rounded-lg font-bold">â• ×”×•×¡×¤×”</button>
            </div>
            <div id="contacts-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
        </section>

        </main>

    <div id="modal" class="fixed inset-0 modal-overlay z-50 hidden flex items-center justify-center p-4">
        <div class="bg-slate-900 border border-slate-800 rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden">
            <div class="p-6 border-b border-slate-800 flex justify-between items-center">
                <h3 id="modal-title" class="text-xl font-bold text-slate-50">×¢×¨×™×›×”</h3>
                <button onclick="closeModal()" class="text-slate-500 hover:text-slate-300 text-2xl">&times;</button>
            </div>
            <div id="modal-content" class="p-6 space-y-4 text-slate-300"></div>
            <div class="p-6 bg-slate-950 flex justify-end gap-3">
                <button onclick="closeModal()" class="px-4 py-2 text-slate-400">×‘×™×˜×•×œ</button>
                <button id="modal-save-btn" class="px-6 py-2 bg-teal-600 text-white rounded-lg font-bold">×©××™×¨×”</button>
            </div>
        </div>
    </div>

    <script>
        // ×©×™××•×© ×‘-var ×”×•×¤×š ××ª ×”××©×ª× ×™× ×œ×’×œ×•×‘×œ×™×™× ×‘×××ª ×•× ×’×™×©×™× ×œ-Firebase
        var checklistData = [{ id: 1, text: "×”×’×“×¨×ª ×©× ××©×ª××© ×•×¡×™×¡××”", done: false }];
        var termsData = [{ id: 1, term: "KPI", definition: "××“×“×™ ×‘×™×¦×•×¢." }];
        var contactsData = [];
        var linksData = [];
        var cultureData = [];
        var currentSection = 'home';
        var editId = null;
        var chartInstance = null;

        function navigateTo(sectionId) {
            document.querySelectorAll('main > section').forEach(s => s.classList.add('hidden'));
            document.getElementById(sectionId).classList.remove('hidden');
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            if(document.getElementById(`nav-${sectionId}`)) document.getElementById(`nav-${sectionId}`).classList.add('active');
            currentSection = sectionId;
            renderAll();
        }

        function renderAll() {
            if (currentSection === 'checklist') renderChecklist();
            if (currentSection === 'dictionary') renderDictionary();
            if (currentSection === 'contacts') renderContacts();
        }

        function renderChecklist() {
            const container = document.getElementById('task-list-container');
            if (!container) return;
            container.innerHTML = checklistData.map(item => `
                <div class="p-4 rounded-lg border flex items-center justify-between bg-slate-900 border-slate-800">
                    <div class="flex items-center gap-4 cursor-pointer" onclick="toggleTask(${item.id})">
                        <div class="w-6 h-6 rounded-full border-2 flex items-center justify-center ${item.done ? 'bg-teal-500' : ''}">${item.done ? 'âœ”' : ''}</div>
                        <span class="${item.done ? 'line-through text-slate-600' : 'text-slate-200'}">${item.text}</span>
                    </div>
                    <button onclick="deleteItem('checklist', ${item.id})" class="text-slate-500 hover:text-red-400">ğŸ—‘ï¸</button>
                </div>
            `).join('');
            updateChart();
        }

        function toggleTaskLogic(id) {
            const t = checklistData.find(x => x.id === id);
            if (t) t.done = !t.done;
            renderChecklist();
        }

        function updateChart() {
            const canvas = document.getElementById('progressChart');
            if (!canvas) return;
            const done = checklistData.filter(x => x.done).length;
            const total = checklistData.length || 1;
            const perc = Math.round((done / total) * 100);
            document.getElementById('progress-text').innerText = `${perc}%`;
            if (chartInstance) chartInstance.destroy();
            chartInstance = new Chart(canvas.getContext('2d'), {
                type: 'doughnut',
                data: { datasets: [{ data: [done, total - done], backgroundColor: ['#14b8a6', '#1e293b'], borderWidth: 0 }] },
                options: { cutout: '80%', maintainAspectRatio: false }
            });
        }

        function openForm(section, id = null) {
            editId = id;
            const modal = document.getElementById('modal');
            const content = document.getElementById('modal-content');
            const data = id ? getDataArray(section).find(x => x.id === id) : {};
            if (section === 'checklist') content.innerHTML = `<input type="text" id="f-text" class="w-full p-3 bg-slate-800 rounded border border-slate-700" value="${data.text || ''}">`;
            document.getElementById('modal-save-btn').onclick = () => saveForm(section);
            modal.classList.remove('hidden');
        }

        function saveFormLogic(section) {
            let arr = getDataArray(section);
            let newItem = { id: editId || Date.now() };
            if (section === 'checklist') newItem.text = document.getElementById('f-text').value;
            if (editId) arr[arr.findIndex(x => x.id === editId)] = { ...newItem };
            else arr.push({ ...newItem, done: false });
            closeModal(); renderAll();
        }

        function deleteItemLogic(section, id) {
            if (section === 'checklist') checklistData = checklistData.filter(x => x.id !== id);
            renderAll();
        }

        function getDataArray(s) { return (s === 'checklist') ? checklistData : (s === 'dictionary') ? termsData : contactsData; }
        function closeModal() { document.getElementById('modal').classList.add('hidden'); }
        window.onload = () => navigateTo('home');
    </script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
        import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDHMgzo-yQ_UGkAXdBPzkJjB7uCGG9_nBs",
            authDomain: "onboarding-kit-60190.firebaseapp.com",
            projectId: "onboarding-kit-60190",
            storageBucket: "onboarding-kit-60190.firebasestorage.app",
            messagingSenderId: "515390708221",
            appId: "1:515390708221:web:a828f2289fe2cfe9602194"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function syncToFirebase() {
            try {
                await setDoc(doc(db, "appData", "currentStatus"), {
                    checklist: checklistData,
                    terms: termsData,
                    lastUpdated: new Date()
                });
                console.log("âœ… ×¡×•× ×›×¨×Ÿ ×œ-Firebase!");
            } catch (e) { console.error("âŒ ×©×’×™××” ×‘×¡× ×›×¨×•×Ÿ:", e); }
        }

        async function loadFromFirebase() {
            try {
                const docSnap = await getDoc(doc(db, "appData", "currentStatus"));
                if (docSnap.exists()) {
                    const data = docSnap.data();
                    if (data.checklist) checklistData = data.checklist;
                    if (data.terms) termsData = data.terms;
                    renderAll();
                    console.log("ğŸ“¥ × ×˜×¢×Ÿ ××”×¢× ×Ÿ!");
                }
            } catch (e) { console.error("âŒ ×©×’×™××” ×‘×˜×¢×™× ×”:", e); }
        }

        window.saveForm = (s) => { saveFormLogic(s); syncToFirebase(); };
        window.deleteItem = (s, i) => { deleteItemLogic(s, i); syncToFirebase(); };
        window.toggleTask = (i) => { toggleTaskLogic(i); syncToFirebase(); };

        window.addEventListener('load', loadFromFirebase);
    </script>
</body>
</html>
